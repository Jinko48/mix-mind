{# macros for app templates #}
<!-- Show flask flashed messages -->
{% macro show_flashed() %}
	{% with messages = get_flashed_messages(with_categories=true) %}
		{% if messages %}
			{% for category, message in messages %}
				<div class="alert alert-{{ 'primary' if category == 'message' else category }} alert-dismissible fade show">
					<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
					{{ message }}
				</div>
			{% endfor %}
		{% endif %}
	{% endwith %}
{% endmacro %}

<!-- Format block for rendering blocks in a form -->
{% macro formheader(title, subtitle=None) %}
<h2>{{ title|safe }}</h2>
{% if subtitle %}
<p class=subtitle>{{ subtitle |safe }}</p>
{% endif %}
{{ show_flashed() }}
{% endmacro %}

<!-- Renders indivdual filds in a from, given WTForm objects -->
{% macro render_field(field) %}
	{% set check_field = ['BooleanField'] %}
	{% set show_label = (field.type not in ['HiddenField', 'SubmitField'] and not field.flags.hidden)  %}
	{% set bootstrap_classes = { 'BooleanField': "form-check-input", 'SubmitField': "btn btn-primary" } %}
<div class="form-group">
	{% if field.type in check_field %}
	<div class="form-check">
	{% endif %}

	{# get extra classes to apply #}
	{% set classes = bootstrap_classes.get(field.type, "form-control") %}
	{% if field.errors %}
	{% set classes = "%s is-invalid"|format(classes) %}
	{% endif %}

	{# render the input field first for checks #}
	{% if field.type in check_field %}
	{{ field(class_=classes, **kwargs)|safe }}
	{% endif %}
	{# render the label #}
	{% if show_label %}
		{% if field.type in check_field %}
		<label class="form-check-label" for="{{ field.id }}">
		{% else %}
		<label class="form-label" for="{{ field.id }}">
		{% endif %}
			{{ field.label.text }}{% if field.flags.required %}*{% endif %}
		</label>
	{% endif %}
	{# render the input field after label for everything else #}
	{% if field.type not in check_field %}
	{{ field(class_=classes, **kwargs)|safe }}
	{% endif %}
	{# render the description #}
	{% if field.description and show_label  %}
	<small id="{{ field.id }}_help" class="form-text text-muted">{{ field.description }}</small>
	{% endif %}

	{# bootstrap form validation #}
	{% if field.errors %}
		{% for error in field.errors %}
		<div class="invalid-feedback">
			{{ error }}
		</div>
		{% endfor %}
	{% endif %}


	{% if field.type in check_field %}
	</div>
	{% endif %}
</div>
{% endmacro %}
