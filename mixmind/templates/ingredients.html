{# template for admin to manage ingredient stock #}
{% extends "dashboard.html" %}
{% from "_macros.html" import show_flashed, render_field %}
{% block dashbody %}

<h3>Ingredient Stock for {{ g.current_bar.cname }}</h3>
{{ show_flashed() }}

<div class="modal fade {% if form_open %} show{% endif %}" id="add-ingredient">
	<div class="modal-dialog" role="document">
		<div class="modal-content">
			<div class="modal-header">
				<h5 class="modal-title">Add Ingredient</h5>
				<button type="button" class="close" data-dismiss="modal" aria-label="Close">
					<span aria-hidden="true">&times;</span>
				</button>
			</div>
			<form  id="add-ingredient-form" action="" method="post" role="form">
				<div class="container-fluid">
					<div class="modal-body">
						{{ form.csrf }}
						{# TODO form layout #}
						{{ render_field(form.bottle) }}
						{{ render_field(form.category) }}
						{{ render_field(form.type_) }}
						{{ render_field(form.abv) }}
						{{ render_field(form.size) }}
						{{ render_field(form.unit) }}
						{{ render_field(form.price) }}
					</div>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-outline-secondary" onclick="clearModalForm()" data-dismiss="modal">Close</button>
					<input type="submit" class="btn btn-success" target="_blank" name="add-ingredient" value="Add"></input>
				</div>
			</form>
		</div>
	</div>
</div>

<div class="modal" id="confirm-delete-ingredient">
	<div class="modal-dialog modal-dialog-centered" role="document">
		<div class="modal-content">
			<div class="modal-header">
				<h5 class="modal-title">Delete Ingredient</h5>
				<button type="button" class="close" data-dismiss="modal" aria-label="Close">
					<span aria-hidden="true">&times;</span>
				</button>
			</div>
			<div class="modal-body">
				<p>Are you sure you want to delete this ingrediant from the database?</p>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-outline-secondary" data-dismiss="modal">Close</button>
				<button type="button" class="btn btn-danger">Confirm Delete</button>
			</div>
		</div>
	</div>
</div>

<form  id="upload_csv" action="" method="post" role="form" enctype="multipart/form-data">
	{{ upload_form.csrf }}
	<a href="#add-barstock" data-toggle="collapse"><h3><i class="fas fa-file-upload"></i> Upload Bar Stock File&nbsp;<i class="fas fa-caret-down"></i></h3></a>
	<div id="add-barstock" class="collapse">
		{{ render_field(upload_form.upload_csv) }}
		{{ render_field(upload_form.replace_existing) }}
		<input type="submit" class="btn btn-primary" target="_blank" name="upload-csv" value="Upload"></input>
	</div>
</form>

<table id="barstock-table" class="table">
	<thead>
		<tr>
			<th scope="col"><button type="button" data-target="#add-ingredient" data-toggle="modal" title="Add an ingredient" class="close"><i class="fas fa-plus"></i></button></th>
			<th scope="col"></th>
			<th scope="col">In Stock</th>
			<th scope="col">Category</th>
			<th scope="col">Type</th>
			<th scope="col">Ingredient</th>
			<th scope="col">ABV</th>
			<th scope="col">Size</th>
			<th scope="col">Size</th>
			<th scope="col">Price</th>
			<th scope="col">$/oz</th>
		</tr>
	</thead>
</table>

{% endblock dashbody %}

{% block scripts %}
<script src="/static/js/ingredient_table.js?v=1.0"></script>
{% endblock scripts %}
